<html>

<head>
  <title>Centrifugo quick start</title>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/gh/centrifugal/centrifuge-js@2.8.4/dist/centrifuge.min.js"></script>
  <script type="text/javascript">
      const centrifuge = new Centrifuge("ws://localhost:8000/connection/websocket");
      centrifuge.setToken("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM3MjIiLCJleHAiOjE2NjI3MjM4MDN9.FVbnQ1c7G0-kowY686IHhhV64IGuxGccOxaquLJMHK4");

      centrifuge.on('connect', function(ctx) {
          console.log("connected", ctx);
      });

      centrifuge.on('disconnect', function(ctx) {
          console.log("disconnected", ctx);
      });

      centrifuge.subscribe("channel", function(ctx) {
          console.log(ctx);

          // обработка offset, нужно запомнить offset предыдущего сообщения для каждого канала отдельно и
          // если offset отличается более чем на 1, то это значит предыдущие сообщения были потеряны
          // и нужно сделать рестарт страницы
      });

      centrifuge.connect();
  </script>
</body>

</html>
